{% extends 'base.html' %}

{% block content %}
<div class="header-section">
    <h2>Manage Class Logins</h2>
    <a href="{{ url_for('admin_dashboard') }}" class="btn-secondary">Back to Dashboard</a>
</div>

<div class="content-row">
    <!-- CREATE NEW LOGIN -->
    <div class="card-section">
        <h3>Create New Class Login</h3>
        <form method="POST" action="{{ url_for('manage_class_logins') }}">

            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required placeholder="e.g., cse_ii_a">
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>

            <div class="form-group">
                <label for="department_id">Department</label>
                <select id="department_id" name="department_id" required>
                    <option value="">Select Department</option>
                    {% for dept in departments %}
                    <option value="{{ dept.id }}">{{ dept.name }} ({{ dept.code }})</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="year">Year</label>
                <input type="number" id="year" name="year" min="1" max="5" required placeholder="e.g., 2">
            </div>

            <div class="form-group">
                <label for="batch">Batch</label>
                <select id="batch" name="batch" required>
                    <option value="I Batch">I Batch</option>
                    <option value="II Batch">II Batch</option>
                </select>
            </div>

            <button type="submit" class="btn-primary">Create Login</button>
        </form>
    </div>

    <!-- LIST EXISTING LOGINS -->
    <div class="card-section">
        <h3>Existing Class Logins</h3>
        <table class="data-table">
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Class (Batch)</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for login in class_logins %}
                <tr>
                    <td>{{ login.username }}</td>
                    <td>{{ login.dept_name }} - Year {{ login.year }} - {{ login.batch }}</td>
                    <td>
                        <form action="{{ url_for('delete_class_login', class_login_id=login.id) }}" method="POST"
                            onsubmit="return confirm('Are you sure?');" style="display:inline;">
                            <button type="submit" class="btn-danger-small">Delete</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="3" style="text-align: center;">No class logins found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
    .content-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        align-items: start;
    }

    @media (max-width: 768px) {
        .content-row {
            grid-template-columns: 1fr;
        }
    }

    .form-group {
        margin-bottom: 1rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--text-color);
        font-weight: 500;
    }

    .form-group input,
    .form-group select {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        font-size: 1rem;
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
    }

    .data-table th,
    .data-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
    }

    .data-table th {
        background-color: var(--bg-light);
        font-weight: 600;
    }

    .btn-danger-small {
        background-color: #ef4444;
        color: white;
        border: none;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.85rem;
    }
</style>
{% endblock %}